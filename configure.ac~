AC_INIT([ksquirrel-libs], [0.5.0], [squirrel-sf@yandex.ru])
AC_GNU_SOURCE
#AC_CONFIG_SRCDIR([config.h.in])
#AM_INIT_AUTOMAKE([foreign])
#AC_CONFIG_HEADER([config.h])

AC_CONFIG_AUX_DIR([admin])

AC_CANONICAL_SYSTEM
AC_ARG_PROGRAM

AM_INIT_AUTOMAKE(ksquirrel-libs, 0.5.0)

AC_CHECK_COMPILERS
AC_ENABLE_SHARED(yes)
AC_ENABLE_STATIC(no)
AC_PROG_LIBTOOL

# Checks for programs.
AC_PROG_CXX
AC_PROG_CC
AC_PROG_CPP
AC_PROG_INSTALL
AC_PROG_LN_S
AC_PROG_MAKE_SET
AC_PROG_RANLIB

# Checks for header files.
AC_HEADER_STDC
AC_CHECK_HEADERS([limits.h stdlib.h strings.h unistd.h stdio.h])

AC_CHECK_HEADER([jpeglib.h], [], AC_MSG_ERROR("JPEG library needs jpeglib.h to be installed."))
AC_CHECK_HEADER([jconfig.h], [], AC_MSG_ERROR("JPEG library needs jconfig.h to be installed."))
AC_CHECK_HEADER([jmorecfg.h], [], AC_MSG_ERROR("JPEG library needs jmorecfg.h to be installed."))
AC_CHECK_HEADER([jerror.h], [], AC_MSG_ERROR("JPEG library needs jerror.h to be installed."))

AC_CHECK_HEADER([png.h], [], AC_MSG_ERROR("PNG library needs png.h to be installed."))

AC_CHECK_LIB([jpeg], [main], [], AC_MSG_ERROR("JPEG library needs libjpeg to be installed."))

# Checks for typedefs, structures, and compiler characteristics.
AC_HEADER_STDBOOL
AC_C_CONST
AC_TYPE_SIZE_T

# Checks for library functions.
AC_FUNC_ERROR_AT_LINE
AC_FUNC_REALLOC
AC_FUNC_STAT
AC_HEADER_SYS_WAIT
AC_CHECK_FUNCS([memset memcpy setjmp])

AC_CONFIG_FILES([Makefile])
AC_CONFIG_FILES([jpeg/Makefile])

AC_OUTPUT
